# The aim is to identify the matching apps belong our 2 datasets which contains technical details of the apps
# With this data we will be analyzing the effect of external factors on apps regardless of reviews
import pandas as pd

dfChild = pd.read_csv("Apps.csv")
dfParent = pd.read_csv("googleplaystore.csv")

# Set the primary key and renamed it
dfParent.rename(columns={"App": "App Name"}, inplace= True)
dfChild.rename(columns={"title": "App Name"}, inplace= True)

# Identified the unmatched apps and updated the App Name colums without including them
merged = pd.merge(dfParent['App Name'], dfChild['App Name'], how='outer', indicator=True)
unmatched = merged[merged['_merge'] == 'left_only']['App Name']
unmatched_2 = merged[merged['_merge'] == 'right_only']['App Name']

dfParent = dfParent[~dfParent['App Name'].isin(unmatched)]
dfChild = dfChild[~dfChild['App Name'].isin(unmatched_2)]

# Dropped the duplicates to have only unique values
dfParent = dfParent.drop_duplicates(['App Name'])
dfChild = dfChild.drop_duplicates(['App Name'])

#print(dfParent.info())
#print(dfChild.info())
